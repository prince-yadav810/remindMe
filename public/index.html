<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>remindME - AI Assistant</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link class="image" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        }

        body { 
            background-color: #1f1e1d;
            color: #e8e8e3;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        }

        .container {
            display: flex;
            height: 100vh;
            flex-direction: row-reverse; /* This moves sidebar to right */
        }

        /* Enhanced Sidebar - Now 247×706px with animations */
        .sidebar {
            min-width: 300px;
            max-width: 300px;
            background-color: #222121;
            padding: 16px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 2;
            order: 2;
            border-left: 1px solid #3a3a38;
            box-sizing: border-box;
            border-radius: 12px 0 0 12px;
            overflow: hidden;
        }

        .sidebar.collapsed {
            min-width: 68px;
            width: 68px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar.hide {
            min-width: 0px;
            width: 0px;
            padding: 0px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar.hoverSidebar {
            position: absolute;
            width: 80px;
            transition: min-width 0.3s ease;
            background-color: #262624;
            top: 0;
            bottom: 0;
            right: 0;
            z-index: 5;
            border-left: 1px solid #3a3a38;
        }

        .sidebar.hoverSidebar-hide {
            width: 0px;
            transition: min-width 0.3s ease;
        }

        /* Enhanced sidebar content with smooth transitions */
        .sidebar-column {
            width: 100%;
            margin-bottom: 16px;
            padding: 0;
        }

        .sidebar-content {
            width: 100%;
            padding: 0;
            margin: 0;
            transition: opacity 0.3s ease, transform 0.3s ease;
            transform: translateX(0);
        }

        .sidebar-content.fade-out {
            opacity: 0;
            transform: translateX(20px);
        }

        .sidebar-content.fade-in {
            opacity: 1;
            transform: translateX(0);
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            margin-bottom: 24px;
            width: 100%;
            transition: all 0.3s ease;
            padding: 0;
        }

        .sidebar-header h3 {
            font-size: 16px;
            font-weight: 600;
            margin: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            color: #e8e8e3;
            font-family: 'Inter', sans-serif;
        }

        .toggle-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            font-size: 20px;
            margin-right: 8px;
            cursor: pointer;
            transition: opacity 0.3s ease;
            z-index: 10;
            display: block;
            color: #b8b8b3;
        }

        .toggle-btn:hover {
            color: #e8e8e3;
        }

        .sidebar ul {
            list-style-type: none;
            padding: 0;
        }

        .sidebar ul li {
            margin-bottom: 10px;
            transition: opacity 0.3s ease;
        }

        .sidebar ul li a {
            display: flex;
            align-items: center;
            color: #b8b8b3;
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-size: 14px;
            font-weight: 400;
            margin-bottom: 2px;
        }

        .sidebar ul li a:hover {
            background-color: #3a3a38;
            color: #e8e8e3;
        }

        .sidebar ul li a:active,
        .sidebar ul li a.active {
            background-color: #c96342;
            color: #ffffff;
        }

        .sidebar ul li a i {
            margin-right: 12px;
            font-size: 16px;
            transition: margin-right 0.3s ease;
            width: 16px;
            text-align: center;
        }

        /* Enhanced time display with subtle animations */
        .time-display {
            background: linear-gradient(135deg, #213031 0%, #1a2828 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            text-align: center;
            width: 100%;
            box-sizing: border-box;
            transition: all 0.3s ease;
            border: 1px solid rgba(74, 204, 209, 0.1);
        }

        .time-display:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(74, 204, 209, 0.1);
            border-color: rgba(74, 204, 209, 0.2);
        }

        .current-time {
            font-size: 28px;
            font-weight: 600;
            color: #e8e8e3;
            font-family: 'Inter', sans-serif;
            margin-bottom: 8px;
            transition: color 0.3s ease;
        }

        .current-date {
            font-size: 14px;
            color: #b8b8b3;
            font-family: 'Inter', sans-serif;
            font-weight: 400;
            transition: color 0.3s ease;
        }

        /* Enhanced reminder section */
        .reminder-section {
            flex: 1;
            margin-bottom: 20px;
            width: 100%;
            padding: 0;
            box-sizing: border-box;
        }

        .reminder-title {
            font-size: 16px;
            font-weight: 600;
            color: #e8e8e3;
            margin-bottom: 16px;
            font-family: 'Inter', sans-serif;
            transition: color 0.3s ease;
        }

        .reminder-list {
            max-height: 480px;
            overflow-y: auto;
            padding-right: 4px;
        }

        .reminder-list::-webkit-scrollbar {
            width: 6px;
        }

        .reminder-list::-webkit-scrollbar-track {
            background: transparent;
        }

        .reminder-list::-webkit-scrollbar-thumb {
            background: #3a3a38;
            border-radius: 3px;
            transition: background 0.3s ease;
        }

        .reminder-list::-webkit-scrollbar-thumb:hover {
            background: #4a4a48;
        }

        /* Enhanced reminder items with animations */
        .reminder-item {
            background-color: #222121;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            border: 1px solid transparent;
            transform: translateY(0);
        }

        .reminder-item:hover {
            background-color: #213031;
            border-color: #4a4a48;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .reminder-time {
            font-size: 12px;
            color: #4accd1;
            font-weight: 500;
            font-family: 'Inter', sans-serif;
        }

        .reminder-date {
            font-size: 11px;
            color: #8a8a88;
            font-weight: 400;
            font-family: 'Inter', sans-serif;
        }

        .reminder-text {
            font-size: 13px;
            color: #e8e8e3;
            line-height: 1.4;
            font-family: 'Inter', sans-serif;
            margin-top: 2px;
        }

        .reminder-description {
            font-size: 12px;
            color: #8a8a88;
            margin-top: 4px;
            font-family: 'Inter', sans-serif;
        }

        .no-reminders {
            text-align: center;
            padding: 24px;
            color: #8a8a88;
        }

        .no-reminders i {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }

        .no-reminders p {
            font-size: 13px;
            margin: 0;
            font-family: 'Inter', sans-serif;
        }

        /* Enhanced action buttons with animations */
        .sidebar-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
            position: absolute;
            bottom: 16px;
            left: 16px;
            right: 16px;
            padding-top: 16px;
            border-top: 1px solid #3a3a38;
        }

        .action-btn {
            background-color: #0f0f0f;
            border: none;
            color: #e8e8e3;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Inter', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .action-btn:hover {
            background-color: #1a1a1a;
            color: #ffffff;
        }

        .action-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .action-btn i {
            font-size: 12px;
        }

        /* Collapsed sidebar styles */
        .sidebar.collapsed ul li a i {
            margin-right: 0;
        }

        .sidebar.collapsed ul li a .sidebar-text {
            display: none;
        }

        .sidebar.collapsed .sidebar-content {
            display: none;
        }

        .sidebar.collapsed .sidebar-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
            position: absolute;
            bottom: 16px;
            left: 8px;
            right: 8px;
            padding-top: 16px;
            border-top: 1px solid #3a3a38;
        }

        .sidebar.collapsed .action-btn {
            padding: 12px;
            border-radius: 8px;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar.collapsed .action-btn span {
            display: none;
        }

        .sidebar.collapsed .action-btn i {
            font-size: 16px;
            margin: 0;
        }

        .sidebar.collapsed .toggle-btn {
            display: block;
        }

        .sidebar.collapsed h3 {
            display: none;
            opacity: 0.5;
            transition: opacity 0.18s ease;
        }

        /* Main Content - Now on the left */
        main {
            flex-grow: 2;
            flex-grow: none;
            overflow: hidden;
            padding: 0px 0px 0px 0px;
            position: relative;
            display: flex;
            flex-direction: column;
            order: 1;
        }

        .chat-container {
            display: flex;
            position: relative;
            flex-direction: column;
            background-color: #2A2A2A;
            margin: 0;
            border-radius: 0;
            margin-bottom: 0px;
            height: 100vh;
            overflow-y: scroll;
            overflow-x: hidden; 
            padding-bottom: 160px;
            border-right: 1px solid #3a3a38;
        }

        .chat-container.scrollable {
           overflow-y: scroll;
           width: 12px;
        }

        .chat-container::-webkit-scrollbar {
            width: 6px;
        }

        .chat-container::-webkit-scrollbar-track {
            background-color: transparent;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background-color: #3a3a38;
            border-radius: 3px;
        }

        .chat-container::-webkit-scrollbar-thumb:hover {
            background-color: #4a4a48;
        }

        .input-box {
            position: relative;
            z-index: 2;
        }

        .chat-window {
            display: flex;
            flex-direction: column;
            background-color: transparent;
            height: 100%;
            overflow-y: hidden;
            align-self: center;
            width: 650px;
            align-items: left;
        }

        .message {
            display: inline-block;
            margin-bottom: 16px;
            font-family: 'Libre Baskerville', Georgia, serif;
            font-size: 14px;
            line-height: 1.6;
            margin-left: 20px;
            margin-right: 20px;
            opacity: 1;
            overflow: hidden;
            color: #e8e8e3;
        }

        .typing-box-container {
            display: flex;
            flex-direction: column;
            z-index: 2;
            justify-content: center;
            justify-self: center;
            justify-items: center;
            align-items: center;
            margin-top: auto;
            align-content: center;
            align-tracks:center;
            align-self: center;
            width: 800px;
            padding: 0 1rem;
            box-sizing: border-box;
            margin-top: calc(0vh - 56px);
            margin-bottom: 20px;
            position: fixed;
            bottom: 0;
            max-width: 100%;
            flex-grow: 20%;
            justify-content: space-between;
        }

        .sidebar.collapsed + main .typing-box-container {
            width: calc(100% - 68px);
        }

        .sidebar.hide ul li a {
            opacity: 0;
        }

        .flex-Typing-Box {
            display: flex;
            padding: 5px;
            width: 100%;
            align-items: center;
            align-self: center;
        }

        .input-box {
            display: flex;
            align-items: flex-end;
            justify-content: right;
            background-color: #1f1e1d;
            padding: 12px 16px;
            border-radius: 12px;
            justify-self: right;
            width: 88%;
            z-index: 2;
            border: 1px solid #3a3a38;
            transition: border-color 0.2s ease;
        }

        .input-box:focus-within {
            border-color: #238588;
        }

        .sidebar.collapsed .input-box {
            justify-content: flex-end;
            width: calc(10% - 182px);
            margin-left: auto;
        }

        .input-box input {
            flex-grow: 1;
            background-color: transparent;
            border: none;
            outline: none;
            color: #fff;
            padding: 5px;
            font-family: 'Roboto', sans-serif;
            resize: vertical;
            overflow-y: auto;
            max-height: 8em;
            z-index: 2;
        }

        .input-box button {
            background-color: #238588;
            color: #ffffff;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            font-size: 14px;
        }

        .input-box button:hover {
            background-color: #238588;
        }

        .input-box button:disabled {
            background-color: #4a4a48;
            color: #8a8a88;
            cursor: not-allowed;
        }

        .input-box button i {
            font-size: 16px;
            z-index: 2;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
            background-color: #2A2A2A;
            position: relative;
            z-index: 2;
            border-bottom: 1px solid #3a3a38;
        }

        .header-left {
            color: #e8e8e3;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            font-family: 'Inter', sans-serif;
        }

        .header-right .share-button {
            background-color: #238588;
            border: none;
            color: #ffffff;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-family: 'Inter', sans-serif;
        }

        .header-right .share-button:hover {
            background-color: #4accd1;
        }

        .message-Input {
          font-size: 18px;
          margin-bottom: 3px;
          margin-left: 3px;
        }

        .div-picture-Button {
            display: flex;
            align-items: middle;
            margin-left: 7px;
            margin-right: 10px;
            z-index: 2;
        }

        .picture-Button {
            border: none;
            color: #b8b8b3;
            background-color: #1f1e1d;
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 12px;
            border-radius: 6px;
            height: 48px;
            width: 48px;
            z-index: 2;
            border: 1px solid #3a3a38;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .picture-Button:hover {
            background-color: #3a3a38;
            color: #e8e8e3;
            border-color: #4a4a48;
        }

        .picture-Button:active {
            background-color: #c96342;
            color: #ffffff;
            border-color: #238588;
        }

        .instructions {
            align-items: center;
            align-self: center;
            font-size: 12px;
            color: #8a8a88;
            display: block;
            z-index: 2;
            font-family: 'Inter', sans-serif;
            font-weight: 400;
        }

        .div-instructions {
            display: block;
            flex-wrap: wrap;
            margin-top: 3px;
            text-align: center;
            z-index: 2;
        }

        .fade-container {
            position: relative;
        }

        .fade-container::before {
            content: "";
            position: absolute;
            left: 0;
            width: 100%;
            height: 160px;
            background: linear-gradient(to top, #1a1a1a 40%, transparent);
            bottom: 0;
            z-index: 1;
        }

        .input-box, .picture-Button {
            position: relative;
            z-index: 2;
        }

        .show-response {
            display:flex;
            flex-direction: column;
        }

        .chat-place {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow:hidden;
            align-self:center;
            width: 700px;
            align-items: left;
            overflow-y: auto;
        }

        .scrollbar {
            display: flex;
            position: absolute;
            top: 0;
            right: 0;
            width: 20px;
            height: 100%;
            background-color: #ccc;
        }

        .additional-content {
            display: flex;
            align-items: center;
            margin-right: 10px;
            display: inline-block;
            object-position: top;
        }

        .logo {
            width: 34px;
            height: 34px;
            margin-right: 0px;
            display: inline-block;
            object-position: top;
            vertical-align:top;
            border-radius: 50px;
        }

        .message-container {
            display: flex;
            position: relative;
            transition: opacity 0.2s;
            flex-direction: row;
            align-items: flex-start;
            margin-bottom: 20px;
            align-self:center;
            width: 70%;
            max-width: 700px;
            opacity: 0;
            overflow-wrap: break-word;
        }

        .dropdown-logo {
            display: flex;
            width: 20px;
            height: 20px;
            margin-right: 5px;
        }

        .input-box div[contenteditable] {
            flex-grow: 1;
            background-color: transparent;
            border: none;
            outline: none;
            color: #e8e8e3;
            padding: 8px 12px;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            line-height: 1.5;
            resize: none;
            overflow: auto;
            min-height: 20px;
            max-height: 120px;
            z-index: 2;
            word-wrap: break-word;
        }

        .input-box div[contenteditable]:empty::before {
            content: attr(data-placeholder);
            color: #8a8a88;
            pointer-events: none;
            font-style: normal;
        }

        /* Welcome message with Libre Baskerville */
        .welcome-greeting {
            font-family: 'Libre Baskerville', Georgia, serif;
            font-size: 32px;
            font-weight: 400;
            color: #e8e8e3;
            text-align: center;
            margin-bottom: 32px;
        }

        .welcome-greeting .icon {
            color: #c96342;
            margin-right: 16px;
            font-size: 24px;
        }

        .mobile-container {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            z-index: 10;
            flex-direction: column;
        }

        .mobileDiv ul {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            justify-content: space-around;
            list-style-type: none;
            padding: 0;
            margin: 0;
            height: 4pc;
        }

        .mobileDiv ul li {
            display: flex;
            flex-direction: column;
            text-align: center;
            justify-self:top;
            justify-content: end; 
        }

        .mobileDiv {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #262624;
            padding: 12px;
            z-index: 10;
            border-top: 1px solid #3a3a38;
        }

        .mobileDiv ul li a {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #b8b8b3;
            text-decoration: none;
            align-items: top;
            align-self: center;
            padding: 8px;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .mobileDiv ul li a i {
            font-size: 18px;
            margin-bottom: 4px;
        }

        .mobileDiv ul li a .sidebar-text {
            font-size: 11px;
            font-weight: 400;
            font-family: 'Inter', sans-serif;
        }

        .mobileDiv ul li a:hover,
        .mobileDiv ul li a.active {
            background-color: #c96342;
            color: #ffffff;
            transform: none;
        }

        .div-typing-box-container {
            display: flex;
            justify-content: center;
            width: 100%;
        }

        /* Loading indicator */
        .loading {
            display: none;
            color: #b8b8b3;
            font-style: normal;
            margin-left: 20px;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            padding: 12px 0;
        }

        /* Chat message formatting styles */
        .message h3 {
            color: #4accd1 !important;
            font-weight: 600 !important;
            margin: 20px 0 12px 0 !important;
            font-size: 18px !important;
            font-family: 'Inter', sans-serif !important;
        }

        .message h4 {
            color: #e8e8e3 !important;
            font-weight: 500 !important;
            margin: 16px 0 8px 0 !important;
            font-size: 16px !important;
            font-family: 'Inter', sans-serif !important;
        }

        .message ul {
            margin: 12px 0 !important;
            padding-left: 20px !important;
            color: #e8e8e3 !important;
        }

        .message li {
            margin: 8px 0 !important;
            line-height: 1.6 !important;
        }

        .message li strong {
            color: #4accd1 !important;
            font-weight: 600 !important;
        }

        .message code {
            background-color: #3a3a38 !important;
            padding: 2px 6px !important;
            border-radius: 4px !important;
            font-family: 'JetBrains Mono', monospace !important;
            font-size: 13px !important;
            color: #e8e8e3 !important;
        }

        .message blockquote {
            border-left: 3px solid #c96342 !important;
            padding: 8px 16px !important;
            margin: 8px 0 !important;
            background-color: #2a2a28 !important;
            color: #e8e8e3 !important;
            font-style: italic !important;
        }

        .message em {
            color: #4accd1 !important;
            font-style: italic !important;
        }

        .message div[style*="background-color: #2a2a28"] {
            background-color: #2a2a28 !important;
            border-left: 3px solid #4accd1 !important;
            padding: 12px !important;
            margin: 8px 0 !important;
            border-radius: 4px !important;
            color: #e8e8e3 !important;
        }

        .message div[style*="display: flex"] {
            display: flex !important;
            background-color: #2a2a28 !important;
            padding: 8px !important;
            margin: 4px 0 !important;
            border-radius: 4px !important;
        }

        .error-message {
            color: #ff6b6b;
            background-color: #2a1a1a;
            padding: 12px 16px;
            border-radius: 8px;
            margin: 12px 20px;
            border-left: 3px solid #ff6b6b;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
        }

        /* History container animations */
        #historyContainer {
            animation: slideInFromRight 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #historyContainer.fade-out {
            animation: slideOutToRight 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .conversation-item {
            animation: fadeInUp 0.3s ease;
            animation-fill-mode: both;
        }

        .conversation-item:nth-child(1) { animation-delay: 0.1s; }
        .conversation-item:nth-child(2) { animation-delay: 0.2s; }
        .conversation-item:nth-child(3) { animation-delay: 0.3s; }
        .conversation-item:nth-child(4) { animation-delay: 0.4s; }
        .conversation-item:nth-child(5) { animation-delay: 0.5s; }

        /* Enhanced processing reminder animation */
        .processing-reminder {
            position: relative;
            overflow: hidden;
            background: linear-gradient(90deg, #213031, #2a3a3b, #213031, #2a3a3b);
            background-size: 300% 100%;
            animation: shimmer 2s infinite;
            border: 1px dashed #4accd1;
            opacity: 0.9;
        }

        /* Animation keyframes */
        @keyframes slideInFromRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideOutToRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }

        @keyframes slideIn {
            from { 
                transform: translateX(100%); 
                opacity: 0; 
            }
            to { 
                transform: translateX(0); 
                opacity: 1; 
            }
        }

        @keyframes slideOut {
            from { 
                transform: translateX(0); 
                opacity: 1; 
            }
            to { 
                transform: translateX(100%); 
                opacity: 0; 
            }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                max-width: 247px;
                height: auto;
                max-height: none;
                border-radius: 0;
            }
        }
    </style>
</head>
<body>
<div class="fade-container">
  <div class="container">
      <nav class="sidebar" id="sidebar">
          <!-- Toggle button positioned at top right -->
          <i class="fas fa-bars toggle-btn" onclick="toggleSidebar()"></i>
          
          <div class="sidebar-content">
              <div class="sidebar-column">
                  <div class="sidebar-header">
                      <h3 id="sidebar-header-text">Dashboard</h3>
                  </div>
              </div>
              
              <div class="sidebar-column">
                  <!-- Time Display Section -->
                  <div class="time-display">
                      <div class="current-time" id="currentTime">12:45 PM</div>
                      <div class="current-date" id="currentDate">Monday, Dec 23, 2024</div>
                  </div>
              </div>
              
              <div class="sidebar-column">
                  <!-- Reminder Section -->
                  <div class="reminder-section">
                      <h4 class="reminder-title">Today's Reminders</h4>
                      <div class="reminder-list" id="reminderList">
                          <div class="no-reminders">
                              <i class="fas fa-calendar-check"></i>
                              <p>No reminders for today</p>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
          
          <!-- Action Buttons at bottom -->
          <div class="sidebar-actions">
              <button class="action-btn" onclick="setReminder()">
                  <i class="fas fa-plus"></i>
                  <span>Set Reminder</span>
              </button>
              <button class="action-btn" onclick="viewHistory()">
                  <i class="fas fa-history"></i>
                  <span>View History</span>
              </button>
          </div>
      </nav>
    <div class="fade-container"></div>

    <main>
        <div id="content">
            <!-- Content will be dynamically loaded here -->
        </div>
        
      <div class="mobileDiv" id="mobileDiv">
        <ul>
          <li><a href="#chatBot"><i class="fas fa-home"></i><span class="sidebar-text">Chat</span></a></li>
              <li><a href="#explore"><i class="fas fa-compass"></i><span class="sidebar-text">Explore</span></a></li>
              <li><a href="#imageGenerator"><i class="fas fa-chart-bar"></i><span class="sidebar-text">Artifacts</span></a></li>
              <li><a href="#library"><i class="fas fa-cog"></i><span class="sidebar-text">Library</span></a></li>
        </ul>
      </div>
     </main> 
  </div>
 </div>

<script>
// Enhanced JavaScript for remindME with Complete Context Management
// ============= CLEAN FIXED JAVASCRIPT FOR INDEX.HTML =============
// REPLACE THE ENTIRE <script> section in your index.html with this:

// Global variables
let sessionId = 'session-' + Date.now();
let currentConversationId = null;
let isLoading = false;
let isHistoryViewActive = false;
let isNewConversation = true;

// ============= TIME AND DATE FUNCTIONALITY =============
function updateTimeDisplay() {
    const now = new Date();
    
    const timeOptions = {
        hour: '2-digit',
        minute: '2-digit',
        hour12: true
    };
    const timeString = now.toLocaleTimeString('en-US', timeOptions);
    
    const dateOptions = {
        weekday: 'long',
        month: 'short',
        day: '2-digit',
        year: 'numeric'
    };
    const dateString = now.toLocaleDateString('en-US', dateOptions);
    
    const timeElement = document.getElementById('currentTime');
    const dateElement = document.getElementById('currentDate');
    
    if (timeElement) timeElement.textContent = timeString;
    if (dateElement) dateElement.textContent = dateString;
}

setInterval(updateTimeDisplay, 1000);
updateTimeDisplay();

// Get current date and time for AI context
function getCurrentDateTime() {
    const now = new Date();
    return {
        date: now.toLocaleDateString('en-US', { 
            weekday: 'long', 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric' 
        }),
        time: now.toLocaleTimeString('en-US', { 
            hour: '2-digit', 
            minute: '2-digit',
            hour12: true 
        }),
        timestamp: now.toISOString()
    };
}

// ============= ERROR HANDLING =============
function handleApiError(error, data) {
    console.error('❌ API Error:', error, data);
    
    if (data?.error) {
        if (data.error.includes('rate limit') || data.error.includes('quota')) {
            showNotification('⏳ API rate limit reached. Please wait a minute and try again.', 'error');
            return 'rate_limit';
        } else if (data.error.includes('reminder')) {
            showNotification('⚠️ Could not create reminder. Please try with more specific time details like "remind me in 2 hours" or "tomorrow at 3pm".', 'error');
            return 'reminder_error';
        } else {
            showNotification(`❌ ${data.error}`, 'error');
            return 'general_error';
        }
    }
    
    showNotification('❌ Something went wrong. Please try again.', 'error');
    return 'unknown_error';
}

// ============= ENHANCED MESSAGE SENDING =============
async function sendMessage() {
    const messageInput = document.getElementById('messageInput');
    const messageText = messageInput.textContent.trim();
    
    if (messageText !== '' && !isLoading) {
        isLoading = true;
        
        console.log('📤 Sending message:', messageText);
        console.log('🔗 Current conversation ID:', currentConversationId);

        // Display user message immediately
        displayMessage(messageText, 'user', true);

        // Clear input
        messageInput.textContent = '';

        // Show enhanced loading indicator
        const chatContainer = document.querySelector('.chat-container');
        const loadingDiv = document.createElement('div');
        loadingDiv.classList.add('loading');
        loadingDiv.innerHTML = '<i class="fas fa-brain fa-pulse" style="margin-right: 8px; color: #4accd1;"></i>Processing with context...';
        chatContainer.appendChild(loadingDiv);
        loadingDiv.style.display = 'block';

        // Scroll to bottom
        chatContainer.scrollTop = chatContainer.scrollHeight;

        // Prepare request with enhanced context
        const requestBody = {
            message: messageText,
            timestamp: new Date().toISOString(),
            clientTimezone: Intl.DateTimeFormat().resolvedOptions().timeZone
        };
        
        // Include conversation ID for context
        if (currentConversationId && !isNewConversation) {
            requestBody.conversationId = currentConversationId;
            console.log('📎 Adding conversation context for:', currentConversationId);
        }

        try {
            const response = await fetch('/api/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(requestBody)
            });
            
            const data = await response.json();
            
            // Remove loading indicator
            loadingDiv.remove();
            
            // Enhanced error handling
            if (!response.ok || data.error) {
                const errorType = handleApiError(response, data);
                
                if (errorType === 'rate_limit') {
                    // Show helpful message for rate limits
                    const helpDiv = document.createElement('div');
                    helpDiv.classList.add('error-message');
                    helpDiv.innerHTML = `
                        <i class="fas fa-clock"></i> 
                        <strong>Rate limit reached</strong><br>
                        The AI service has reached its daily limit. Please try again in a few minutes, or try:
                        <ul style="margin: 8px 0; padding-left: 20px;">
                            <li>Use more specific times: "remind me at 3pm tomorrow"</li>
                            <li>Create reminders manually using the + button</li>
                        </ul>
                    `;
                    chatContainer.appendChild(helpDiv);
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                    return;
                }
                
                throw new Error(data.error || 'Request failed');
            }

            console.log('✅ API Response:', data);

            // Update conversation tracking
            if (data.conversationId) {
                if (!currentConversationId || isNewConversation) {
                    currentConversationId = data.conversationId;
                    sessionId = data.sessionId;
                    isNewConversation = false;
                    console.log('🆕 New conversation created:', currentConversationId);
                    
                    if (data.conversationTitle) {
                        console.log('📝 Conversation titled:', data.conversationTitle);
                    }
                } else {
                    console.log('📝 Continuing conversation:', currentConversationId);
                }
            }

            // Display bot response
            let botResponse = data.message || data.response;
            
            // Enhanced reminder processing feedback
            if (data.trigger) {
                console.log('🎯 Trigger activated - processing reminder...');
                showReminderProcessingAnimation();
                botResponse += '<br><div class="status-indicator trigger" style="background-color: #c96342; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; margin: 8px 0; display: inline-block;"><i class="fas fa-cogs fa-spin"></i> Processing reminder with enhanced time parsing...</div>';
            }
            
            displayMessage(botResponse, 'assistant', true);

            // Enhanced reminder creation feedback
            if (data.trigger) {
                if (data.reminder_created) {
                    console.log('✅ Reminder successfully created:', data.reminder_created);
                    
                    setTimeout(() => {
                        removeReminderProcessingAnimation();
                        loadReminders();
                        
                        // Enhanced success message
                        const method = data.reminder_created.calculationMethod === 'AI_calculated' ? 'AI-calculated' : 'parsed';
                        showNotification(`✅ Reminder created (${method}): ${data.reminder_created.title}`, 'success');
                        
                        const statusIndicator = document.querySelector('.status-indicator.trigger');
                        if (statusIndicator) {
                            statusIndicator.innerHTML = '<i class="fas fa-check"></i> Reminder created with enhanced time parsing!';
                            statusIndicator.style.backgroundColor = '#4accd1';
                        }
                    }, 800);
                    
                } else {
                    setTimeout(() => {
                        removeReminderProcessingAnimation();
                        
                        // More helpful error message
                        const helpText = 'Try more specific formats like: "remind me in 2 hours", "tomorrow at 3pm", or "next Monday at 10am"';
                        showNotification('⚠️ Could not create reminder. ' + helpText, 'error');
                        
                        const statusIndicator = document.querySelector('.status-indicator.trigger');
                        if (statusIndicator) {
                            statusIndicator.innerHTML = '<i class="fas fa-info-circle"></i> Try more specific time format';
                            statusIndicator.style.backgroundColor = '#ff9800';
                        }
                    }, 1500);
                }
            }

            // Scroll to bottom
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
        } catch (error) {
            loadingDiv.remove();
            removeReminderProcessingAnimation();
            
            const errorDiv = document.createElement('div');
            errorDiv.classList.add('error-message');
            errorDiv.innerHTML = `<i class="fas fa-exclamation-triangle"></i> Error: ${error.message}`;
            chatContainer.appendChild(errorDiv);
            
            console.error('❌ Error:', error);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        } finally {
            isLoading = false;
        }
    }
}

// ============= NEW CHAT FUNCTION =============
async function startNewChat() {
    try {
        console.log('🆕 Starting new chat...');
        
        // Reset conversation tracking
        currentConversationId = null;
        sessionId = 'session-' + Date.now();
        isNewConversation = true;
        
        // Clear chat container
        const chatContainer = document.querySelector('.chat-container');
        if (chatContainer) {
            const messageContainers = chatContainer.querySelectorAll('.message-container, .error-message, .loading');
            messageContainers.forEach(container => container.remove());
        }
        
        // Call API to mark previous conversations as inactive
        await fetch('/api/new-chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        });
        
        // Hide history view if active
        if (isHistoryViewActive) {
            hideHistoryView();
            isHistoryViewActive = false;
        }
        
        console.log('✅ New chat started successfully');
        showNotification('New chat started', 'success');
        
    } catch (error) {
        console.error('❌ Error starting new chat:', error);
        showNotification('Error starting new chat', 'error');
    }
}

// ============= HISTORY VIEW FUNCTIONS =============
async function viewHistory() {
    console.log('🔄 Toggling history view. Current state:', isHistoryViewActive);
    
    if (isHistoryViewActive) {
        hideHistoryView();
    } else {
        await showHistoryView();
    }
    
    isHistoryViewActive = !isHistoryViewActive;
}

async function showHistoryView() {
    console.log('📚 Showing history view...');
    
    const sidebar = document.getElementById('sidebar');
    const sidebarContent = sidebar.querySelector('.sidebar-content');
    
    if (!sidebarContent) {
        console.error('Sidebar content not found');
        return;
    }
    
    // Hide existing sidebar content
    sidebarContent.style.display = 'none';
    
    // Create history container
    const historyContainer = document.createElement('div');
    historyContainer.id = 'historyContainer';
    historyContainer.className = 'sidebar-content';
    historyContainer.style.cssText = `
        width: 100%;
        padding: 0;
        margin: 0;
        height: calc(100vh - 100px);
        overflow-y: auto;
    `;
    
    // Add header
    const historyHeader = document.createElement('div');
    historyHeader.className = 'sidebar-header';
    historyHeader.style.cssText = `
        display: flex;
        align-items: center;
        justify-content: flex-start;
        margin-bottom: 24px;
        width: 100%;
        padding: 0;
    `;
    historyHeader.innerHTML = `
        <h3 style="color: #e8e8e3; font-size: 16px; font-weight: 600; margin: 0; font-family: 'Inter', sans-serif;">
            Chat History
        </h3>
    `;
    
    // Add loading indicator
    const loadingDiv = document.createElement('div');
    loadingDiv.style.cssText = `
        text-align: center;
        padding: 20px;
        color: #b8b8b3;
        font-family: 'Inter', sans-serif;
    `;
    loadingDiv.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading conversations...';
    
    historyContainer.appendChild(historyHeader);
    historyContainer.appendChild(loadingDiv);
    sidebar.appendChild(historyContainer);
    
    // Load conversations
    try {
        const conversations = await loadConversationHistory();
        
        // Remove loading indicator
        loadingDiv.remove();
        
        if (conversations.length === 0) {
            const noHistory = document.createElement('div');
            noHistory.style.cssText = `
                text-align: center;
                padding: 40px 20px;
                color: #8a8a88;
                font-family: 'Inter', sans-serif;
            `;
            noHistory.innerHTML = `
                <i class="fas fa-comments" style="font-size: 24px; margin-bottom: 12px; display: block;"></i>
                <p style="font-size: 14px; margin: 0;">No conversations yet</p>
                <p style="font-size: 12px; margin: 4px 0 0 0; color: #6a6a68;">Start a new chat to begin</p>
            `;
            historyContainer.appendChild(noHistory);
        } else {
            const conversationList = document.createElement('div');
            conversationList.style.cssText = `
                padding: 0 8px;
                max-height: calc(100vh - 180px);
                overflow-y: auto;
            `;
            
            conversations.forEach(conversation => {
                const conversationItem = createConversationItem(conversation);
                conversationList.appendChild(conversationItem);
            });
            
            historyContainer.appendChild(conversationList);
        }
        
        console.log('✅ History view shown successfully');
        
    } catch (error) {
        console.error('Error loading conversation history:', error);
        loadingDiv.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Error loading history';
    }
}

function hideHistoryView() {
    console.log('🔒 Hiding history view...');
    
    const sidebar = document.getElementById('sidebar');
    const historyContainer = document.getElementById('historyContainer');
    const originalContent = sidebar.querySelector('.sidebar-content[style*="display: none"]');
    
    if (historyContainer) {
        historyContainer.style.transition = 'opacity 0.3s ease';
        historyContainer.style.opacity = '0';
        
        setTimeout(() => {
            historyContainer.remove();
            console.log('History container removed');
            
            if (originalContent) {
                originalContent.style.display = 'block';
                originalContent.style.transition = 'opacity 0.3s ease';
                originalContent.style.opacity = '0';
                
                setTimeout(() => {
                    originalContent.style.opacity = '1';
                    console.log('Original sidebar content restored');
                }, 50);
            }
        }, 300);
    }
}

// ============= CONVERSATION MANAGEMENT =============
async function loadConversationHistory() {
    try {
        console.log('📚 Loading conversation history...');
        const response = await fetch('/api/conversations');
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
            console.log(`Found ${data.conversations.length} conversations`);
            return data.conversations;
        } else {
            console.error('Failed to load conversations:', data.message);
            return [];
        }
    } catch (error) {
        console.error('Error loading conversation history:', error);
        showNotification('Error loading conversation history', 'error');
        return [];
    }
}

async function loadConversation(conversationId) {
    try {
        console.log('📖 Loading conversation:', conversationId);
        const response = await fetch(`/api/conversations/${conversationId}`);
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
            currentConversationId = conversationId;
            sessionId = data.conversation.sessionId;
            isNewConversation = false;
            
            // Switch to chat view if not already there
            if (window.location.hash !== '#chatBot') {
                window.location.hash = '#chatBot';
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            // Clear current chat and load messages
            const chatContainer = document.querySelector('.chat-container');
            if (chatContainer) {
                const messageContainers = chatContainer.querySelectorAll('.message-container, .error-message, .loading');
                messageContainers.forEach(container => container.remove());
                
                // Load conversation messages
                data.conversation.messages.forEach((message, index) => {
                    displayMessage(message.content, message.role, false);
                });
                
                // Scroll to bottom
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
            
            console.log('✅ Conversation loaded successfully');
            
            // Hide history view
            if (isHistoryViewActive) {
                hideHistoryView();
                isHistoryViewActive = false;
            }
            
            showNotification(`Loaded: ${data.conversation.title}`, 'success');
            return true;
        } else {
            console.error('Failed to load conversation:', data.message);
            return false;
        }
    } catch (error) {
        console.error('Error loading conversation:', error);
        return false;
    }
}

function createConversationItem(conversation) {
    const item = document.createElement('div');
    item.style.cssText = `
        background-color: #222121;
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 1px solid transparent;
        transform: scale(1);
    `;
    
    // Format last activity time
    const lastActivity = new Date(conversation.lastActivity);
    const now = new Date();
    const diffHours = Math.floor((now - lastActivity) / (1000 * 60 * 60));
    const diffDays = Math.floor(diffHours / 24);
    
    let timeText;
    if (diffHours < 1) {
        timeText = 'Just now';
    } else if (diffHours < 24) {
        timeText = `${diffHours}h ago`;
    } else if (diffDays < 7) {
        timeText = `${diffDays}d ago`;
    } else {
        timeText = lastActivity.toLocaleDateString();
    }
    
    item.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 4px;">
            <div style="color: #e8e8e3; font-size: 13px; font-weight: 500; font-family: 'Inter', sans-serif; line-height: 1.3; flex: 1; margin-right: 8px;">
                ${conversation.title}
            </div>
            <div style="color: #8a8a88; font-size: 11px; font-family: 'Inter', sans-serif; white-space: nowrap;">
                ${timeText}
            </div>
        </div>
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div style="color: #8a8a88; font-size: 11px; font-family: 'Inter', sans-serif;">
                ${conversation.messageCount} messages
            </div>
            ${conversation.isActive ? '<div style="width: 6px; height: 6px; background-color: #4accd1; border-radius: 50%;"></div>' : ''}
        </div>
    `;
    
    // Enhanced hover effects
    item.addEventListener('mouseenter', function() {
        this.style.backgroundColor = '#213031';
        this.style.borderColor = '#4a4a48';
        this.style.transform = 'scale(1.02) translateY(-2px)';
        this.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.3)';
    });
    
    item.addEventListener('mouseleave', function() {
        this.style.backgroundColor = '#222121';
        this.style.borderColor = 'transparent';
        this.style.transform = 'scale(1) translateY(0)';
        this.style.boxShadow = 'none';
    });
    
    // Add click handler
    item.addEventListener('click', async function() {
        console.log('🖱️ Loading conversation:', conversation.id);
        
        this.style.backgroundColor = '#c96342';
        this.style.color = '#ffffff';
        this.style.transform = 'scale(0.98)';
        
        const originalContent = this.innerHTML;
        this.innerHTML = '<div style="text-align: center; color: #ffffff;"><i class="fas fa-spinner fa-spin"></i> Loading...</div>';
        
        const success = await loadConversation(conversation.id);
        
        if (!success) {
            this.innerHTML = originalContent;
            this.style.backgroundColor = '#ff6b6b';
            showNotification('Failed to load conversation', 'error');
            
            setTimeout(() => {
                this.style.backgroundColor = '#222121';
                this.style.color = '';
                this.style.transform = 'scale(1)';
            }, 2000);
        }
    });
    
    return item;
}

// ============= MESSAGE DISPLAY =============
function displayMessage(content, role, animate = true) {
    const chatContainer = document.querySelector('.chat-container');
    if (!chatContainer) return;

    const messageContainer = document.createElement('div');
    messageContainer.classList.add('message-container');

    const additionalContent = document.createElement('div');
    additionalContent.classList.add('additional-content');

    // Create avatar
    const avatar = document.createElement('div');
    avatar.style.cssText = `
        width: 34px; height: 34px; border-radius: 6px; 
        display: flex; align-items: center; justify-content: center;
        font-weight: 600; margin-right: 0px; font-size: 14px;
        font-family: 'Inter', sans-serif;
    `;

    if (role === 'user') {
        avatar.style.background = '#3a3a38';
        avatar.style.color = '#e8e8e3';
        avatar.textContent = 'You';
    } else {
        avatar.style.background = '#238588';
        avatar.style.color = '#ffffff';
        avatar.innerHTML = '<i class="fas fa-robot"></i>';
    }

    additionalContent.appendChild(avatar);

    // Create message content
    const messageDiv = document.createElement('div');
    messageDiv.classList.add('message');
    
    const prefix = role === 'user' ? '<strong>You:</strong><br>' : '<strong>remindME:</strong><br>';
    const formattedContent = role === 'assistant' ? formatBotResponse(content) : content.replace(/\n/g, "<br>");
    messageDiv.innerHTML = prefix + formattedContent;

    messageContainer.appendChild(additionalContent);
    messageContainer.appendChild(messageDiv);
    chatContainer.appendChild(messageContainer);

    if (animate) {
        messageContainer.style.opacity = '0';
        messageContainer.style.transform = 'translateY(20px)';
        setTimeout(() => {
            messageContainer.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
            messageContainer.style.opacity = '1';
            messageContainer.style.transform = 'translateY(0)';
        }, 100);
    } else {
        messageContainer.style.opacity = '1';
    }
}

// ============= REMINDER FUNCTIONS =============
async function loadReminders() {
    try {
        console.log('=== Loading reminders from API ===');
        const response = await fetch('/api/reminders');
        const data = await response.json();
        
        console.log('Full API response:', data);
        
        if (data.upcoming_reminders && data.upcoming_reminders.length > 0) {
            console.log(`Found ${data.upcoming_reminders.length} upcoming reminders`);
            displayReminders(data.upcoming_reminders);
        } else if (data.today_reminders && data.today_reminders.length > 0) {
            console.log(`Fallback: Found ${data.today_reminders.length} today's reminders`);
            displayReminders(data.today_reminders);
        } else if (data.all_reminders) {
            console.log('Filtering all reminders for upcoming dates on frontend...');
            const today = new Date();
            const nextWeek = new Date(today.getTime() + (7 * 24 * 60 * 60 * 1000));
            
            const upcomingReminders = data.all_reminders.filter(reminder => {
                if (!reminder.completed && reminder.date) {
                    const reminderDate = new Date(reminder.date);
                    return reminderDate >= today && reminderDate <= nextWeek;
                }
                return false;
            });
            console.log(`Filtered ${upcomingReminders.length} upcoming reminders`);
            displayReminders(upcomingReminders);
        } else {
            console.log('No reminders data found in response');
            displayReminders([]);
        }
    } catch (error) {
        console.error('Error loading reminders:', error);
    }
}

function formatTime12Hour(time24) {
    if (!time24) return 'All day';
    
    const [hours, minutes] = time24.split(':');
    const hour = parseInt(hours);
    const minute = minutes;
    const ampm = hour >= 12 ? 'PM' : 'AM';
    const hour12 = hour % 12 || 12;
    
    return `${hour12}:${minute} ${ampm}`;
}

function formatDateForReminder(dateStr) {
    if (!dateStr) return '';
    
    const reminderDate = new Date(dateStr);
    const today = new Date();
    const tomorrow = new Date(today);
    tomorrow.setDate(today.getDate() + 1);
    
    const reminderDateOnly = new Date(reminderDate.getFullYear(), reminderDate.getMonth(), reminderDate.getDate());
    const todayOnly = new Date(today.getFullYear(), today.getMonth(), today.getDate());
    const tomorrowOnly = new Date(tomorrow.getFullYear(), tomorrow.getMonth(), tomorrow.getDate());
    
    if (reminderDateOnly.getTime() === todayOnly.getTime()) {
        return 'Today';
    } else if (reminderDateOnly.getTime() === tomorrowOnly.getTime()) {
        return 'Tomorrow';
    } else {
        const options = reminderDate.getFullYear() !== today.getFullYear() 
            ? { month: 'short', day: 'numeric', year: 'numeric' }
            : { month: 'short', day: 'numeric' };
        return reminderDate.toLocaleDateString('en-US', options);
    }
}

function displayReminders(reminders) {
    console.log('=== Displaying reminders ===');
    
    const reminderList = document.getElementById('reminderList');
    const noReminders = reminderList.querySelector('.no-reminders');
    
    if (!reminderList) {
        console.error('reminderList element not found!');
        return;
    }
    
    const existingReminders = reminderList.querySelectorAll('.reminder-item');
    existingReminders.forEach(item => item.remove());
    
    if (!reminders || reminders.length === 0) {
        if (noReminders) {
            noReminders.style.display = 'block';
        }
        return;
    }
    
    if (noReminders) {
        noReminders.style.display = 'none';
    }
    
    reminders.forEach((reminder, index) => {
        const timeFormatted = formatTime12Hour(reminder.time);
        const dateFormatted = formatDateForReminder(reminder.date);
        
        const reminderItem = document.createElement('div');
        reminderItem.className = 'reminder-item';
        reminderItem.style.cssText = `
            background-color: #222121;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
        `;
        
        const headerDiv = document.createElement('div');
        headerDiv.style.cssText = `
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        `;
        
        const timeSpan = document.createElement('span');
        timeSpan.className = 'reminder-time';
        timeSpan.textContent = timeFormatted;
        
        const dateSpan = document.createElement('span');
        dateSpan.className = 'reminder-date';
        dateSpan.textContent = dateFormatted !== 'Today' ? dateFormatted : '';
        
        headerDiv.appendChild(timeSpan);
        headerDiv.appendChild(dateSpan);
        
        const titleDiv = document.createElement('div');
        titleDiv.className = 'reminder-text';
        titleDiv.textContent = reminder.title;
        
        reminderItem.appendChild(headerDiv);
        reminderItem.appendChild(titleDiv);
        
        if (reminder.description) {
            const descriptionDiv = document.createElement('div');
            descriptionDiv.className = 'reminder-description';
            descriptionDiv.textContent = reminder.description;
            reminderItem.appendChild(descriptionDiv);
        }
        
        reminderItem.addEventListener('mouseenter', function() {
            this.style.backgroundColor = '#213031';
        });
        reminderItem.addEventListener('mouseleave', function() {
            this.style.backgroundColor = '#222121';
        });
        
        if (noReminders) {
            reminderList.insertBefore(reminderItem, noReminders);
        } else {
            reminderList.appendChild(reminderItem);
        }
    });
}

function showReminderProcessingAnimation() {
    const reminderList = document.getElementById('reminderList');
    const noReminders = reminderList.querySelector('.no-reminders');
    
    const processingItem = document.createElement('div');
    processingItem.className = 'reminder-item processing-reminder';
    processingItem.id = 'processing-reminder';
    processingItem.innerHTML = `
        <div class="reminder-time">
            <i class="fas fa-circle-notch fa-spin" style="color: #4accd1; margin-right: 4px;"></i>
            Processing...
        </div>
        <div class="reminder-text">Creating your reminder...</div>
    `;
    
    if (noReminders && noReminders.style.display !== 'none') {
        noReminders.style.display = 'none';
    }
    
    if (noReminders) {
        reminderList.insertBefore(processingItem, noReminders);
    } else {
        reminderList.appendChild(processingItem);
    }
}

function removeReminderProcessingAnimation() {
    const processingItem = document.getElementById('processing-reminder');
    if (processingItem) {
        processingItem.style.animation = 'fadeOut 0.3s ease-out';
        setTimeout(() => {
            if (processingItem.parentNode) {
                processingItem.parentNode.removeChild(processingItem);
            }
        }, 300);
    }
}

function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 20px;
        background-color: ${type === 'success' ? '#4accd1' : type === 'error' ? '#ff6b6b' : '#c96342'};
        color: white;
        border-radius: 8px;
        z-index: 1000;
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        max-width: 300px;
        word-wrap: break-word;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        animation: slideIn 0.3s ease-out;
    `;
    
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease-in';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

function formatBotResponse(text) {
    let formatted = text.replace(/</g, '&lt;').replace(/>/g, '&gt;');
    
    formatted = formatted.replace(/(^|\s)\*\*([^*\n]+?)\*\*:?(\s|$)/gm, '$1<h3 style="color: #4accd1; font-weight: 600; margin: 20px 0 12px 0; font-size: 18px; font-family: \'Inter\', sans-serif;">$2</h3>$3');
    
    formatted = formatted.replace(/^###\s+(.+?)$/gm, '<h4 style="color: #e8e8e3; font-weight: 500; margin: 16px 0 8px 0; font-size: 16px; font-family: \'Inter\', sans-serif;">$1</h4>');
    formatted = formatted.replace(/^##\s+(.+?)$/gm, '<h3 style="color: #4accd1; font-weight: 600; margin: 20px 0 12px 0; font-size: 18px; font-family: \'Inter\', sans-serif;">$1</h3>');
    
    let lines = formatted.split('\n');
    let inList = false;
    let processedLines = [];
    
    for (let i = 0; i < lines.length; i++) {
        let line = lines[i].trim();
        
        if (/^\*\s+/.test(line)) {
            if (!inList) {
                processedLines.push('<ul style="margin: 12px 0; padding-left: 20px; color: #e8e8e3; list-style-type: disc;">');
                inList = true;
            }
            let listContent = line.substring(2).trim();
            listContent = listContent.replace(/\*\*([^*]+?)\*\*/g, '<strong style="color: #4accd1;">$1</strong>');
            processedLines.push(`<li style="margin: 8px 0; line-height: 1.6; display: list-item;">${listContent}</li>`);
        } else {
            if (inList) {
                processedLines.push('</ul>');
                inList = false;
            }
            if (line.length > 0) {
                processedLines.push(line);
            } else if (!inList) {
                if (processedLines.length > 0 && processedLines[processedLines.length - 1] !== '') {
                    processedLines.push('');
                }
            }
        }
    }
    
    if (inList) {
        processedLines.push('</ul>');
    }
    
    formatted = processedLines.join('\n');
    formatted = formatted.replace(/^(\d+\.\s+)(.+?)$/gm, '<div style="margin: 8px 0; color: #e8e8e3;"><span style="color: #c96342; font-weight: 600;">$1</span>$2</div>');
    formatted = formatted.replace(/(?<!\*)\*([^*\s][^*]*?[^*\s])\*(?!\*)/g, '<em style="color: #c96342; font-style: italic;">$1</em>');
    formatted = formatted.replace(/`([^`\n]+?)`/g, '<code style="background-color: #3a3a38; padding: 2px 6px; border-radius: 4px; font-family: \'JetBrains Mono\', monospace; font-size: 13px; color: #e8e8e3;">$1</code>');
    formatted = formatted.replace(/\[([^\[\]]+?)\]/g, '<div style="background-color: #2a2a28; border-left: 3px solid #c96342; padding: 12px; margin: 12px 0; border-radius: 4px; color: #e8e8e3;">$1</div>');
    formatted = formatted.replace(/^&gt;\s*(.+?)$/gm, '<blockquote style="border-left: 3px solid #c96342; padding: 8px 16px; margin: 12px 0; background-color: #2a2a28; color: #e8e8e3; font-style: italic;">$1</blockquote>');
    formatted = formatted.replace(/\n\s*\n+/g, '</p><p>');
    formatted = '<p>' + formatted + '</p>';
    formatted = formatted.replace(/<p>\s*<\/p>/g, '');
    formatted = formatted.replace(/<p>\s*(<\/?(ul|li|h[3-4]|div|blockquote))/g, '$1');
    formatted = formatted.replace(/(<\/?(ul|li|h[3-4]|div|blockquote)[^>]*>)\s*<\/p>/g, '$1');
    formatted = formatted.replace(/<p>\s*(<\/?(ul|li|h[3-4]|div|blockquote)[^>]*>)/g, '$1');
    formatted = formatted.replace(/(<\/?(ul|li|h[3-4]|div|blockquote)[^>]*>)\s*<p>/g, '$1');
    formatted = formatted.replace(/\n/g, ' ');
    formatted = formatted.replace(/\s+/g, ' ');
    formatted = formatted.replace(/(<\/p>)\s*(<p>)/g, '$1$2');
    
    return formatted.trim();
}

// ============= MANUAL REMINDER FUNCTIONS =============
function setReminder() {
    const reminderText = prompt("Enter your reminder:");
    const reminderTime = prompt("Enter time (e.g., 3:30 PM or 15:30):");
    const reminderDate = prompt("Enter date (YYYY-MM-DD) or leave empty for today:");
    
    if (reminderText && reminderTime) {
        const today = new Date().toISOString().split('T')[0];
        const finalDate = reminderDate || today;
        
        const time24 = convertTo24Hour(reminderTime);
        
        createReminderAPI(reminderText, time24, finalDate);
    }
}

function convertTo24Hour(time12) {
    if (!time12) return null;
    
    if (!/AM|PM/i.test(time12)) {
        return time12;
    }
    
    const [time, modifier] = time12.split(/\s*(AM|PM)/i);
    let [hours, minutes] = time.split(':');
    
    if (hours === '12') {
        hours = '00';
    }
    
    if (modifier.toUpperCase() === 'PM') {
        hours = parseInt(hours, 10) + 12;
    }
    
    return `${hours.toString().padStart(2, '0')}:${minutes || '00'}`;
}

async function createReminderAPI(title, time, date, description = '') {
    try {
        console.log('Creating reminder via API:', { title, time, date, description });
        showReminderProcessingAnimation();
        
        const response = await fetch('/api/reminders', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                title: title,
                time: time,
                date: date,
                description: description
            })
        });
        
        const data = await response.json();
        console.log('Manual reminder creation response:', data);
        
        if (data.reminder) {
            setTimeout(() => {
                removeReminderProcessingAnimation();
                loadReminders();
                showNotification('Reminder created successfully!', 'success');
            }, 800);
        } else {
            removeReminderProcessingAnimation();
            showNotification('Error creating reminder', 'error');
        }
    } catch (error) {
        console.error('Error creating reminder:', error);
        removeReminderProcessingAnimation();
        showNotification('Error creating reminder', 'error');
    }
}

// ============= UI FUNCTIONS =============
function checkZoomLevel() {
    var zoomLevel = Math.round(window.devicePixelRatio * 100);
    var sidebar = document.getElementById('sidebar');
    var screenWidth = window.innerWidth;
    var mobileDiv = document.getElementById('mobileDiv');

    if (zoomLevel > 400 || screenWidth <= 700) {
        sidebar.classList.add('hide');
        sidebar.classList.remove('collapsed');
        mobileDiv.style.display = 'block';
    } else if (zoomLevel > 300 || screenWidth <= 900) {
        sidebar.classList.add('collapsed');
        mobileDiv.style.display = 'none';
    } else {
        sidebar.classList.remove('collapsed');
        sidebar.classList.remove('hide');
        sidebar.style.display = 'block';
        mobileDiv.style.display = 'none';
    }
}

function toggleSidebar() {
    var sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('collapsed');
}

// ============= NAVIGATION =============
window.addEventListener('hashchange', () => {
    const content = document.getElementById('content');
    const hash = window.location.hash.slice(1);
    
    switch(hash) {
        case 'chatBot':
            content.innerHTML = `
                <div class="header">
                    <div class="header-left">remindME</div>
                    <div class="header-right">
                        <button class="share-button" onclick="startNewChat()">
                            <i class="fas fa-plus" style="margin-right: 6px;"></i>New chat
                        </button>
                    </div>
                </div>
                <div class="chat-container" id="chatContainer">
                    <div class="message-container" id="messageContainer"></div>
                </div>
                <div class="div-typing-box-container">
                    <div class="typing-box-container">
                        <div class="flex-Typing-Box">
                            <div class="input-box">
                                <div class="message-Input" id="messageInput" contenteditable="true" data-placeholder="How can I help you today?" onkeydown="if(event.keyCode==13 && !event.shiftKey){sendMessage();return false;}"></div>
                                <button onclick="sendMessage()"><i class="fas fa-arrow-up"></i></button>
                            </div>
                            <div class="div-picture-Button">
                                <button class="picture-Button">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <div class="div-instructions">
                            <p><span class="instructions">remindME can make mistakes. Check important info.</span></p>
                        </div>
                    </div>
                </div>`;
            break;
        case 'explore':
            content.innerHTML = `
                <div class="header">
                    <div class="header-left">Projects</div>
                    <div class="header-right">
                        <button class="share-button"><i class="fas fa-briefcase"></i></button>
                    </div>
                </div>
                <div class="chat-container" id="chatContainer">
                    <div style="text-align: center; margin-top: 120px; padding: 0 40px;">
                        <div class="welcome-greeting">
                            <span class="icon">🚀</span>Projects
                        </div>
                        <p style="color: #b8b8b3; font-family: 'Inter', sans-serif; font-size: 16px; line-height: 1.6;">Organize your work and collaborate with others</p>
                    </div>
                </div>`;
            break;
        case 'imageGenerator':
            content.innerHTML = `
                <div class="header">
                    <div class="header-left">Artifacts</div>
                    <div class="header-right">
                        <button class="share-button"><i class="fas fa-cube"></i></button>
                    </div>
                </div>
                <div class="chat-container">
                    <div style="text-align: center; margin-top: 120px; padding: 0 40px;">
                        <div class="welcome-greeting">
                            <span class="icon">🎨</span>Artifacts
                        </div>
                        <p style="color: #b8b8b3; font-family: 'Inter', sans-serif; font-size: 16px; line-height: 1.6;">Create and edit documents, code, and more</p>
                    </div>
                </div>`;
            break;
        case 'library':
            content.innerHTML = `
                <div class="header">
                    <div class="header-left">Library</div>
                    <div class="header-right">
                        <button class="share-button"><i class="fas fa-bookmark"></i></button>
                    </div>
                </div>
                <div class="chat-container">
                    <div style="text-align: center; margin-top: 120px; padding: 0 40px;">
                        <div class="welcome-greeting">
                            <span class="icon">📚</span>Your Library
                        </div>
                        <p style="color: #b8b8b3; font-family: 'Inter', sans-serif; font-size: 16px; line-height: 1.6;">Your saved chats and bookmarks</p>
                    </div>
                </div>`;
            break;
        default:
            content.innerHTML = `
                <div class="header">
                    <div class="header-left">remindME</div>
                    <div class="header-right">
                        <button class="share-button" onclick="startNewChat()">
                            <i class="fas fa-plus" style="margin-right: 6px;"></i>New chat
                        </button>
                    </div>
                </div>
                <div class="chat-container" id="chatContainer">
                    <div style="text-align: center; margin-top: 120px; padding: 0 40px;">
                        <div class="welcome-greeting">
                            <span class="icon">✨</span>Hello there!
                        </div>
                        <p style="color: #b8b8b3; font-family: 'Inter', sans-serif; font-size: 16px; line-height: 1.6; margin-bottom: 40px;">How can I help you today?</p>
                    </div>
                </div>
                <div class="div-typing-box-container">
                    <div class="typing-box-container">
                        <div class="flex-Typing-Box">
                            <div class="input-box">
                                <div class="message-Input" id="messageInput" contenteditable="true" data-placeholder="How can I help you today?" onkeydown="if(event.keyCode==13 && !event.shiftKey){sendMessage();return false;}"></div>
                                <button onclick="sendMessage()"><i class="fas fa-arrow-up"></i></button>
                            </div>
                            <div class="div-picture-Button">
                                <button class="picture-Button">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <div class="div-instructions">
                            <p><span class="instructions">remindME can make mistakes. Check important info.</span></p>
                        </div>
                    </div>
                </div>`;
    }
});

// ============= EVENT LISTENERS =============
window.addEventListener('resize', checkZoomLevel);
window.addEventListener('load', checkZoomLevel);

document.addEventListener('keydown', function(event) {
    if (event.ctrlKey && event.key === '/') { 
        event.preventDefault();
        const messageInput = document.getElementById('messageInput');
        if (messageInput) {
            messageInput.focus();
        }
    }
});

// ============= INITIALIZATION =============
document.addEventListener('DOMContentLoaded', function() {
    loadReminders();
    setInterval(loadReminders, 5 * 60 * 1000);
});

// Initial load
if (!window.location.hash) {
    window.location.hash = '#chatBot';
}
window.dispatchEvent(new Event('hashchange'));
</script>
</body>
</html>